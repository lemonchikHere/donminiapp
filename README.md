# Don Estate - Бэкенд для Telegram Mini App

Это бэкенд-система для Telegram Mini App по недвижимости "Don Estate".

## Основные возможности

-   **Парсинг Telegram-каналов:** Сбор объявлений о недвижимости.
-   **REST API:** Предоставление данных для фронтенда.
-   **Геокодирование:** Определение координат по адресу через Yandex Maps API.
-   **Семантический поиск:** Поиск объектов по текстовому описанию с использованием AI.
-   **Уведомления:** Отправка уведомлений администратору и пользователям.

## Установка и запуск

### 1. Подготовка окружения

-   **Склонируйте репозиторий:**
    ```bash
    git clone <URL вашего репозитория>
    cd <имя папки>
    ```

-   **Создайте файл `.env`:**
    Скопируйте `.env.example` и заполните необходимые переменные (ключи API, данные для подключения к БД и т.д.).
    ```bash
    cp .env.example .env
    ```

-   **Создайте директорию для медиафайлов:**
    ```bash
    mkdir -p media
    ```

### 2. Запуск с помощью Docker

Все сервисы запускаются в Docker-контейнерах.

-   **Сборка и запуск контейнеров:**
    Эта команда соберет образы и запустит все сервисы в фоновом режиме.
    ```bash
    sudo docker-compose up -d --build
    ```

-   **Активация расширения `pgvector`:**
    Для работы семантического поиска необходимо активировать расширение в PostgreSQL.
    ```bash
    sudo docker-compose exec postgres psql -U postgres -d don_estate -c "CREATE EXTENSION IF NOT EXISTS vector;"
    ```

-   **Применение миграций базы данных (если используется Alembic):**
    ```bash
    sudo docker-compose exec api alembic upgrade head
    ```

### 3. Настройка pre-commit хуков (Рекомендуется)

Для поддержания чистоты кода и автоматических проверок перед коммитом, настройте pre-commit хуки.

-   **Установите зависимости:**
    ```bash
    pip install pre-commit black flake8
    ```

-   **Активируйте хуки:**
    ```bash
    pre-commit install
    ```
    Теперь `black` и `flake8` будут автоматически проверять ваш код перед каждым коммитом.

## Запуск тестов

Для проверки корректности работы API можно запустить тесты:
```bash
sudo docker-compose exec api pytest
```
